@using Amazon.GenAI.Models
﻿@using Amazon.GenAI.Models

@* <div class="upload-container @(Status != Status.Thinking ? "" : "hidden")">
    <MudFileUpload T="IReadOnlyList<IBrowserFile>"
                   @bind-Files="@Files"
                   Accept="@Accept"
                   OnFilesChanged="@OnFileChangedCallback"
                   For="@(() => Files!)"
                   Hidden="false"
                   InputClass="absolute inset-0 opacity-0 w-full h-full cursor-pointer"
                   MaximumFileCount="FileCount"
                   Class="relative">
        <ButtonTemplate>
            <MudIconButton Icon="@Icons.Material.Filled.Upload" 
                           Color="Color.Primary"
                           Size="Size.Medium"
                           Class="pointer-events-none" />
        </ButtonTemplate>
    </MudFileUpload>
</div> *@

<div class="upload-container @(Status != Status.Thinking ? "" : "hidden")">
        <MudFileUpload T="IReadOnlyList<IBrowserFile>"
                       @bind-Files="@Files"
                       Accept="@Accept"
                       OnFilesChanged="@OnFileChangedCallback"
                       For="@(() => Files!)"
                       Hidden="false"
                       MaximumFileCount="FileCount">
            <ButtonTemplate>
                <MudIconButton Icon="@Icons.Material.Filled.Upload" 
                               Color="Color.Primary"
                               Size="Size.Medium"
                               Class="mx-2" />
            </ButtonTemplate>
        </MudFileUpload>
    </div>


@code {
    [Parameter, EditorRequired]
    public string? Accept { get; set; }

    [Parameter, EditorRequired]
    public IReadOnlyList<IBrowserFile>? Files { get; set; }

    [Parameter, EditorRequired] public int FileCount { get; set; } = 0;

    [Parameter, EditorRequired]
    public Status Status { get; set; }

    private const string DefaultDragClass = "relative rounded-lg border-2 border-dashed pa-4 mt-4 mud-width-full mud-height-full z-10";
    private string _dragClass = DefaultDragClass;
    private string Pluralize => FileCount > 1 ? "s" : "";

    [Parameter]
    public EventCallback<InputFileChangeEventArgs> OnFileChangedCallback { get; set; }

    private void SetDragClass()
    {
        _dragClass = $"{DefaultDragClass} mud-border-primary";
    }

    private void ClearDragClass()
    {
        _dragClass = DefaultDragClass;
    }
}